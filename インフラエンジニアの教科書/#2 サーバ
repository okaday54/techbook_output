概要

サーバーとは
ユーザーからのリクエストを受けてレスポンスを返すハードウェアのこと
ITインフラの要

(サーバの種類)
ラックマウント型
データセンターや社内サーバのラックに設置

タワー型
オフィスや店舗
静音サーバを用いることもできる。

サーバの特徴
①冷却と騒音対策が必要
②重い
数kg〜数十kgのものがる。
高密度に設置する場合床面の耐荷重に注意

区分
・エントリーサーバー
数十万円。webサーバーなど。ソケット単位で1or2個のCPU搭載可能

・ミドルレンジサーバ
数百万円。データベースや基幹系。ソケット単位で4個以上のCPUが搭載可能

・ハイエンドサーバ
数千万円〜数億円。データベースや基幹系。ソケット単位で数十個のCPUが搭載可能

IAサーバ
インテル互換CPUを搭載、パソコンと同様のアーキテクチャをベースにして製造されたサーバのこと

エンタープライズサーバ
基幹系に使われるサーバ

##サーバの選定
インフラ構築を考える際、無数にある選択肢を減らし、ポイントを絞って吟味。

サーバ要件
必要なハードウェアリソースの使用量を決め、RAID有無、PSU(パワーサプライユニット)冗長化要否、保守の年数、保守レベル、拡張性、物理サイズや重量を併せて決めていく。

サーバ要件を決める要素
CPU
メモリ
ディスク
RAID
NIC
PSU
保守年数
保守レベル
拡張性
物理サイズ
重量

サーバスペックを決める考え方
①実際の環境を試験的に構築し、測定結果から判断する
②仮決めしたサーバスペック機器を本番投入し、実際のハードウェアリソース利用状況を測定した上でサーバやサーバのパーツを増減していく。
③消去法でスペックを絞り込んでいく


サーバのキャパシティ向上のアプローチ
スケールアウト
台数を増やしていく

スケールアップ
性能を上げていく

国内で入手可能なサーバの主要ベンダー
DELL
NEC
日本HP
日本IBM
日本オラクル
日本ユニシス
日立製作所
富士通

CPU
性能を良くする、動作周波数を上げると消費電力も大きくなる。
これ以上の、性能アップは消費電力が大きくなるデメリットのほうが大きい

マルチコア、マルチスレッド、といった手法を用いて同時に処理できる数を増やし性能アップを図る

性能 = 演算能力
性能を上げる = 動作周波数を上げる

CPU用語
ソケット数：物理的なCPUの搭載数
動作周波数：1秒間に刻むクロックの数。高いと処理が速くなるが、電力効率が悪くなり発熱が増える。
コア：主要演算回路のこと。コアの数だけ同時に演算ができる。
キャッシュ：頻繁にアクセスするデータを置き、低速なメインメモリへのアクセスを減らしCPUの処理性能を上げる

ハイパースレッディング
OS上で１つのコアを2つのCPUに見せる技術(intel社の用語)

ターボブーストテクノロジー
仕事をしていないコアを使って、仕事をしているコアをクロックアップさせる技術(intel社の用語)

CPU選定のポイント
パフォーマンス
求める演算能力を満たすかどうか

コア数
複数のOSを動かす場合、コア数を多いCPUを選定
バッチプログラムなど、シングルプロセスソフトウェアの場合は１つのコアしか使われないため、コア数が多いCPUに変えても意味がない

ソケット数
コア数の多いCPUに変更する他に、物理的なCPUを複数個搭載する方法もある
８コア１ソケットと、４コア２ソケットでは、後者のほうが遅くなる場合がある。
NUMAが原因。別のCPUのメモリにアクセスする場合は低速になってしまうため。

価格対比
消費電力
使うソフトウェアのライセンス体系
CPUのコア数やソケット数によって価格が変わるソフトウェアがある

■メモリ
短期記憶領域。
電源が停止するとデータは消える。
重要なのは搭載容量の大きさ。
サーバ用メモリの場合、耐障害性、パフォーマンス、省電力が重視。

パフォーマンス
メモリの速さを考える場合、メモリ自体の速さとCPUや各種バス間の通信を行う際のデータ転送幅の広さの両面から考慮する。

(メモリ用語)
スロット数
メモリはマザーボードに挿す。

ECCmemory
メモリ故障によりビット反転エラーが発生したときに自動補正・検知できるように、誤り訂正符号(ECC)と呼ばれるパリティ情報が追加されているメモリ

チャネル
チャネルごとに同一種類のメモリを搭載することでデータ幅を増やしパフォーマンスを向上させる

ランク
メモリコントローラーがDRAMからデータを入力する単位のこと

UDIMM
バッファなしDIMM

RDIMM
レジスタ付きDIMM

LRDIMM
RDIMMを発展させた方式。メモリコントローラとメモリチップ間のすべての通信をバッファ回路を介して行うDIMM

LV(低電圧)
通常のメモリよりも電圧を下げることで省電力を実現したメモリのこと

ハードディスクの種類
SATAハードディスク
安価。１日８時間程度の稼働用途。

SASハードディスク
高信頼。高速。24時間365日稼働

FCハードディスク
高信頼。超高速。SANストレージなど、エンタープライズ用途。

ニアラインハードディスク
オンライン・オフラインの中間の状態。
アーカイブの長期保存など、１日数時間程度の利用を想定。

SSD
半導体素子メモリを用いた、高速・低電力。高価。
弱点：書き込み、消去を繰り返すと素子が劣化。業務用途では書き込み回数の多いものを利用。

RAID
パフォーマンス向上、耐障害性の向上

RAIDとは、
2台以上のHDDを仮想的に1つのドライブであるようにPCに認識させる技術のことです。 
RAIDにはいくつかモードがありますが、データの安全性を高められたり、処理速度の向上が見込めたりするなど、モードによって特徴が異なります。

RAIDレベル
７種類。
RAID0：耐障害性のないディスクアレイ(ストライピング)
RAID1：二重化(ミラーリング)
RAID5：ブロック単位でのパリティ情報記録
RAID６：２種類のパリティ情報記録。5よりも耐障害性が高い。
RAID10：RAID1をストライピングしたもの

仮想化
１台の物理サーバーの上に複数のゲストOSを稼働させること。サーバ仮想化と呼ぶ。
リソースを自由に割り当てることで、うまく使えば大幅なコストダウンにつながる。

物理サーバ
主な用途：データベース、アプリケーションサーバ

仮想サーバ
主な用途：Webサーバ、開発サーバ、メモリDBなど

仮想化するメリット
コストダウン
ゲストOSのハードウェアリソースの増減を容易に行える
物理サーバは老朽化する。交換後も仮想化環境を用意し簡単に移行できる。

仮想化のデメリット
他のゲストOSがハードウェアリソースを大量に使うと動作が不安定になる
未使用になっても撤去されずに残りがち。管理の問題。物理サーバより撤去されにくい傾向。

仮想化環境の種類
(有償ソフト)
VMware vSphere
Hyper-V / マイクロソフト

(オープンソース)
Xen / Linux foundation
KVM / Qumranet

VMware vSphere
仮想化業界でのリーダー。安定性と使いやすさはトップクラス。

Hyper-V
マイクロソフトが提供する仮想化ソリューション
無制限にWindows ServerをゲストOSとして稼働させる権利を与えられるプランが有る。
コストメリットが見込める。
無償バージョンも存在する。

Xen
Iaas型クラウドとしてAWSが利用していることでも有名。
Linuxカーネル3系ではカーネル変更することなくホストOS/ゲストOSとして利用できる。

KVM
Linuxカーネルで標準機能

クラウド(IaaS)
クラウドはSaaS,PaaS,IaaSの3種類から構成。

Saasサース：アプリケーションをサービスとして提供
Paasパース：アプリケーション実行環境を提供
Iaas：システムインフラを提供

Iaasの特徴
・物理サーバを持たずに使える
・物理サーバを管理するエンジニアが不要
・短期間でOSがインストールされた状態で使える
・利用したい分だけサーバ増強が可能
・従量課金制
・資産を持たずに済む。減価償却処理が不要。

AWS
IaaSの世界で最も影響力がある
中核サービスとして
EC2：仮想サーバ。1時間単位の従量課金制。
S3：仮想ストレージ。月単位の従量課金制。

クラウドの弱点
大量のハードウェアリソースの追加に弱い
障害が発生した場合クラウドベンダーからの復旧完了通知を待つしかない
クラウドベンダーの手違いで重要なデータが消去するリスクがある
実際に発生しているので、バックアップの対策は必要。

クラウドに向かない用途
機密情報を置く
大容量ファイルの転送
大規模システム
→自社で持ったほうが安くなる


